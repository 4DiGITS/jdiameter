<?xml version='1.0' encoding='UTF-8'?>
<!-- This document was created with Syntext Serna Free. --><!DOCTYPE section PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "docbookV4.5/docbookx.dtd" []>
<section id="dr-Diameter_Rf">
  <title>Mobicents Diameter Rf</title>
<!--Note: Developer: This section hasn't been edited at all, because it is so similar to the Ro section that it is impossible to differentiate between the two. You need to merge the two sections, and then concisely explain the differences between the two. Otherwise it is both a waste of space and confusing for the user.
Content: glad You dont have to read TS :). Ro/Rf are very alike, with very few differences, possibly only in use case cause. Scenarios are very similar with different application in real life.-->  <para>Rf is one of two IMS reference points for charging. It covers offline charging - scenarios  where charging information does not affect, in real-time, the service rendered. </para>
  <para>Difference to Ro interface is that information/requests sent from CTF to CDF do  not affect service delivery. CTF only informs CDF about units consumption.  .</para>
  <para>For contrast with Ro(which is almost identical) consider regular phone call.  User accessing platform is <emphasis role="bold">premium user</emphasis> - that means he is bound to one of better  phone plans. Provider charges him only on call start - that is, user is not cahrfed for call length. This requires only information on call initiation to perform initial charging(there might be different rates depending on area/country code/time).</para>
  <para>For detailed information on Rf interface please refer to information found  <ulink url="http://www.3gpp.org/ftp/Specs/html-info/32299.htm">here</ulink> and <ulink url="http://www.3gpp.org/ftp/Specs/html-info/32240.htm">here</ulink></para>
  <para>Charging involves two peers:</para>
  <itemizedlist>
    <listitem>
      <para>CTF (Charging Trigger Function) - makes decision how to charge specific service for user, issues request/requests to server(CDF)</para>
    </listitem>
    <listitem>
      <para>CDF (Charging Data Function) - performs actual charging based on received message type, service logic and user profile information.</para>
    </listitem>
  </itemizedlist>
  <para>As per definition from technical specification Rf reuses messages defined in Diameter Base. For more information about base please refer to <xref linkend="db-Diameter_Base"/> </para>
  <figure id="rf-Figure_Event_Charging_Flow">
    <title>Event Charging Flow</title>
    <mediaobject>
      <imageobject>
        <imagedata fileref="images/dia-RfExamples-dia-EventFlow.jpg" format="JPEG"/>
      </imageobject>
    </mediaobject>
  </figure>
  <para>Above diagram shows event based charging. Actions performed in diagram can be described as follows:<itemizedlist>
      <listitem>
        <para>(1) CTF(actually its AS) delivers service to UA</para>
      </listitem>
      <listitem>
        <para>(2) CTF sends ACR with Record-Type AVP set to enum value of &quot;EVENT&quot;</para>
      </listitem>
      <listitem>
        <para>(3) CDF response after charging</para>
      </listitem>
    </itemizedlist></para>
  <figure id="rf-Figure_Session_Charging_Flow">
    <title>Session Charging Flow</title>
    <mediaobject>
      <imageobject>
        <imagedata fileref="images/dia-RfExamples-dia-SessionFlow.jpg" format="JPEG"/>
      </imageobject>
    </mediaobject>
  </figure>
  <para>Above diagram shows session based charging. Performed actions can be described as follows:</para>
  <itemizedlist>
    <listitem>
      <para>(1) Service is being delivered to UA</para>
    </listitem>
    <listitem>
      <para>(2) CTF sends ACR with Record-Type AVP equal to enum value of &quot;START&quot;. This indicates that session is being established</para>
    </listitem>
    <listitem>
      <para>(3) CDF processes received ACR</para>
    </listitem>
    <listitem>
      <para>(4) CDF responds with ACA, acknowledging charge operation</para>
    </listitem>
    <listitem>
      <para>(5) CTF sends interim ACR(this can happen zero or more times). This is sent once predefined time elapses.It contains additional charge information. Record-Type AVP equals to enum value of &quot;INTERIM&quot;.</para>
    </listitem>
    <listitem>
      <para>(6) Processes received ACR</para>
    </listitem>
    <listitem>
      <para>(7) CDF responds with ACA, acknowledging charge operation</para>
    </listitem>
    <listitem>
      <para>(8) Service for UA has been terminated</para>
    </listitem>
    <listitem>
      <para>(9) CTF creates terminating ACR. It contains last charge information for session. Record-Type AVP is equal to enum value of &quot;STOP&quot;</para>
    </listitem>
    <listitem>
      <para>(10) CDF process received ACR</para>
    </listitem>
    <listitem>
      <para>(11) CDF responds with ACA, acknowledging charge operation</para>
    </listitem>
  </itemizedlist>
  <para>Cx/Dx interface depends on following resources:</para>
  <itemizedlist>
    <listitem>
      <para>MUX</para>
    </listitem>
    <listitem>
      <para>Base RA</para>
    </listitem>
    <listitem>
      <para>Credit Control Application RA (CCA RA)</para>
    </listitem>
    <listitem>
      <para>Ro RA</para>
    </listitem>
  </itemizedlist>
  <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="section-Diameter_Rf_Configuration.xml" encoding="UTF-8"/>
  <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="section-Diameter_Rf_Resource_Adapter_Type.xml" encoding="UTF-8"/>
  <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="section-Diameter_Rf_API_Usage_Example.xml" encoding="UTF-8"/>
  <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="section-Diameter_Rf_Examples.xml" encoding="UTF-8"/>
</section>
